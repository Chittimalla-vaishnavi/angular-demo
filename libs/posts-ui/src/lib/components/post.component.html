<div class="container">
  <div class="page-actions">
    <p-button
      label="Add Post"
      [raised]="true"
      severity="success"
      (click)="addPost()"
    />
  </div>
  <div class="card">
    <p-table
      [value]="posts()"
      [tableStyle]="{ 'min-width': '60rem' }"
      [resizableColumns]="true"
      columnResizeMode="expand"
      styleClass="p-datatable-gridlines"
      sortMode="single"
    >
      <ng-template #header>
        <tr>
          <th pSortableColumn="body" pResizableColumn style="width: 20%">
            <div class="flex items-center gap-2">
              Body
              <p-sortIcon field="body" />
            </div>
          </th>
          <th pSortableColumn="title" pResizableColumn style="width: 20%">
            <div class="flex items-center gap-2">
              title
              <p-sortIcon field="title" />
            </div>
          </th>
          <th pSortableColumn="user.name" pResizableColumn style="width: 20%">
            <div class="flex items-center gap-2">
              Produced By
              <p-sortIcon field="user.name" />
            </div>
          </th>
          <th pSortableColumn="quantity" style="width: 20%">
            <div class="flex items-center gap-2">Actions</div>
          </th>
        </tr>
      </ng-template>
      <ng-template #body let-post>
        <tr>
          <td>{{ post.body }}</td>
          <td>{{ post.title }}</td>
          <td>{{ post.user.name }}</td>
          <td>
            <div class="actions-btn">
              <p-button
                label="Edit"
                severity="info"
                (click)="onEditPost(post)"
              />
              <p-button
                label="Delete"
                severity="danger"
                (click)="onDeletePost(post.id)"
              />
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>

<!-- Add Post -->
<p-dialog [(visible)]="visible" header="Add Post" [style]="{ width: '450px' }">
  <form [formGroup]="form">
    <div class="form-group">
      <label for="title" class="form-label">Title</label>
      <input
        id="title"
        type="text"
        formControlName="title"
        pInputText
        class="flex-1"
      />
    </div>
    <div class="form-group">
      <label for="body" class="form-label">Body</label>
      <textarea rows="5" cols="30" pTextarea formControlName="body"></textarea>
    </div>
  </form>

  <ng-template pTemplate="footer">
    <p-button
      label="Cancel"
      severity="secondary"
      (click)="visible = false"
    ></p-button>
    <p-button label="Save" (click)="createPost()"></p-button>
  </ng-template>
</p-dialog>

<!-- Edit Post -->
<p-dialog
  header="Edit Post"
  [modal]="true"
  [(visible)]="editPost"
  [style]="{ width: '25rem' }"
>
  <form [formGroup]="form">
    <div class="form-group">
      <label htmlFor="title-input" class="form-label">Title</label>
      <input
        id="title-input"
        type="text"
        pInputText
        formControlName="title"
        readonly
      />
    </div>

    <div class="form-group">
      <label htmlFor="body-input" class="form-label">Body</label>
      <textarea
        id="body-input"
        rows="5"
        cols="30"
        pTextarea
        formControlName="body"
      ></textarea>
    </div>
  </form>
  <div class="add-post-action-btns">
    <p-button label="Cancel" severity="secondary" (click)="editPost = false" />
    <p-button label="Save" (click)="saveEdit()" />
  </div>
</p-dialog>

<!-- Delete Post -->
<p-dialog
  header="Delete Post"
  [modal]="true"
  [(visible)]="isDeletePost"
  [style]="{ width: '25rem' }"
>
  <span class="p-text-secondary block mb-8"
    >Are you sure, you want to Delete?</span
  >
  <div class="add-post-action-btns">
    <p-button
      label="Cancel"
      severity="secondary"
      (click)="isDeletePost = false"
    />
    <p-button label="Delete" (click)="deletePost()" />
  </div>
</p-dialog>
